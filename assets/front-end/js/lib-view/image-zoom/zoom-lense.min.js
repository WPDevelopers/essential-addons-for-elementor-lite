!function(e){e.fn.eaelZoomLense=function(t){let o=e.extend({lensWidth:100,lensHeight:100,borderRadius:"50%",lensBorder:"1px solid #aaa",resultBorder:"1px solid #aaa",gap:10,autoResize:!1,minLensSize:40,maxLensSize:300,step:10,zoomId:t.zoomId?"zoom_"+t.zoomId:"zoom"},t);return e(this).on("mouseenter touchstart mousemove touchmove",function(t){let n=e(this),i=o.zoomId;if(e(".eael-lens-"+i).length||e(".eael-result-"+i).length)return;let l=o.lensWidth,s=o.lensHeight,r=e("<div>",{class:"eael-lens-"+i,css:{position:"absolute",pointerEvents:"none",borderRadius:o.borderRadius,border:o.lensBorder,backgroundColor:"rgba(255,255,255,0.3)",zIndex:999}}).appendTo("body"),a=e("<div>",{class:"eael-result-"+i,css:{position:"absolute",border:o.resultBorder,backgroundRepeat:"no-repeat",zIndex:998}}).appendTo("body"),u=n.offset();function p(){let t=n.outerWidth(),i=n.outerHeight(),l=t,s=i,r=o.gap,a=e(window).width(),p=e(window).height(),f=e(window).scrollLeft(),d=e(window).scrollTop(),h=a-(u.left-f+t),c=u.left-f,m=p-(u.top-d+i),g=u.top-d,$={top:u.top,left:u.left};return h>=l+r?($.left=u.left+t+r,$.top=u.top):c>=l+r?($.left=u.left-l-r,$.top=u.top):m>=s+r?($.left=u.left,$.top=u.top+i+r):g>=s+r?($.left=u.left,$.top=u.top-s-r):($.left=Math.min(u.left+t+r,f+a-l-10),$.top=Math.min(u.top,d+p-s-10),$.left=Math.max($.left,f+10),$.top=Math.max($.top,d+10)),$}let f=p();function d(e){let t=e.originalEvent.touches?e.originalEvent.touches[0]:e,o=t.pageX,i=t.pageY,u=n.offset(),p=o-l/2,f=i-s/2,d=u.left+n.outerWidth()-l,h=u.top+n.outerHeight()-s;p=Math.max(u.left,Math.min(p,d)),f=Math.max(u.top,Math.min(f,h)),r.css({width:l,height:s,top:f,left:p,display:"block"});let c=a.width()/l,m=a.height()/s;a.css({display:"block",backgroundPosition:`-${(p-u.left)*c}px -${(f-u.top)*m}px`})}a.css({width:n.outerWidth(),height:n.outerHeight(),top:f.top,left:f.left,backgroundImage:`url(${n.attr("src")})`,backgroundSize:`${n.outerWidth()*(n.outerWidth()/l)}px ${n.outerHeight()*(n.outerHeight()/s)}px`}),o.autoResize&&e(window).on("wheel."+i,function(e){if(!r.is(":visible"))return;e.preventDefault();let t=e.originalEvent.deltaY,i=t>0?1:-1,u=Math.max(o.minLensSize,Math.min(o.maxLensSize,l-i*o.step)),p=Math.max(o.minLensSize,Math.min(o.maxLensSize,s-i*o.step)),f=(l-u)/2,d=(s-p)/2;l=u,s=p;let h=r.offset();r.css({width:l,height:s,top:h.top+d,left:h.left+f});let c=a.width()/l,m=a.height()/s,g=n.offset();a.css({backgroundSize:`${n.outerWidth()*c}px ${n.outerHeight()*m}px`,backgroundPosition:`-${(r.offset().left-g.left)*c}px -${(r.offset().top-g.top)*m}px`})}),e(document).on("mousemove."+i+" touchmove."+i,d),e(window).on("scroll."+i+" resize."+i,function e(){let t=p();a.css({top:t.top,left:t.left})}),n.on("mouseleave."+i+" touchend."+i,function(){r.remove(),a.remove(),e(document).off("mousemove."+i+" touchmove."+i),e(window).off("wheel."+i+" scroll."+i+" resize."+i),n.off("mouseleave."+i+" touchend."+i)}),d(t)}),this},e.fn.eaelMagnify=function(t){let o=e.extend({lensSize:200,zoom:2,lensBorder:"2px solid #fff"},t);return this.each(function(){let t=e(this),n=null,i=o.zoom,l=!1;function s(){if(l)return;l=!0;let s=t[0].naturalWidth,r=t[0].naturalHeight;function a(e){if(!n)return;let o=t.offset(),l=t.width(),a=t.height(),u=e.pageX-o.left,p=e.pageY-o.top;if(u<0||p<0||u>l||p>a){n.css("opacity",0);return}let f=s*i,d=r*i,h=u/l*s*i-n.width()/2,c=p/a*r*i-n.height()/2;n.css({left:`${e.pageX-n.width()/2}px`,top:`${e.pageY-n.height()/2}px`,backgroundPosition:`-${h}px -${c}px`,backgroundSize:`${f}px ${d}px`,opacity:1})}t.on("mouseenter touchstart mousemove touchmove",function(){n||(n=e('<div class="eael-magnify-lens"></div>').css({width:o.lensSize,height:o.lensSize,border:o.lensBorder,backgroundImage:`url(${t.attr("src")})`,backgroundRepeat:"no-repeat",pointerEvents:"none",opacity:0,boxShadow:"0 5px 10px rgba(0, 0, 0, 0.2)",borderRadius:"50%",transition:"opacity 0.2s",position:"absolute",zIndex:9999}),e("body").append(n))}),t.on("mousemove touchmove",a),t.on("mouseleave touchend",function(){n&&(n.css("opacity",0),setTimeout(()=>{n?.remove(),n=null},200))}),t.on("wheel",function(e){if(!n)return;e.preventDefault();let t=e.originalEvent.deltaY||e.originalEvent.wheelDelta;i=t>0?Math.max(1,i-.1):Math.min(5,i+.1),a(e)})}t[0].complete&&t[0].naturalWidth?s():t.one("load",s)})}}(jQuery);