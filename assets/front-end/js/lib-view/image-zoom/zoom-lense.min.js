!function(e){e.fn.eaelZoomLense=function(t){let o=e.extend({lensWidth:100,lensHeight:100,borderRadius:"50%",lensBorder:"1px solid #aaa",resultBorder:"1px solid #aaa",gap:10,autoResize:!1,minLensSize:40,maxLensSize:300,step:10,zoomId:t.zoomId?"zoom_"+t.zoomId:"zoom"},t);return e(this).on("mouseenter touchstart mousemove touchmove",function(t){let i=e(this),s=o.zoomId;if(e(".eael-lens-"+s).length||e(".eael-result-"+s).length)return;let n=o.lensWidth,r=o.lensHeight,l=e("<div>",{class:"eael-lens-"+s,css:{position:"absolute",pointerEvents:"none",borderRadius:o.borderRadius,border:o.lensBorder,backgroundColor:"rgba(255,255,255,0.3)",zIndex:999}}).appendTo("body"),a=e("<div>",{class:"eael-result-"+s,css:{position:"absolute",border:o.resultBorder,backgroundRepeat:"no-repeat",zIndex:998}}).appendTo("body"),u=i.offset();function d(e){let t=e.originalEvent.touches?e.originalEvent.touches[0]:e,o=t.pageX,s=t.pageY,u=i.offset(),d=o-n/2,h=s-r/2,p=u.left+i.outerWidth()-n,f=u.top+i.outerHeight()-r;d=Math.max(u.left,Math.min(d,p)),h=Math.max(u.top,Math.min(h,f)),l.css({width:n,height:r,top:h,left:d,display:"block"});let m=a.width()/n,c=a.height()/r;a.css({display:"block",backgroundPosition:`-${(d-u.left)*m}px -${(h-u.top)*c}px`})}a.css({width:i.outerWidth(),height:i.outerHeight(),top:u.top,left:u.left+i.outerWidth()+o.gap,backgroundImage:`url(${i.attr("src")})`,backgroundSize:`${i.outerWidth()*(i.outerWidth()/n)}px ${i.outerHeight()*(i.outerHeight()/r)}px`}),o.autoResize&&e(window).on("wheel."+s,function(e){if(!l.is(":visible"))return;e.preventDefault();let t=e.originalEvent.deltaY,s=t>0?1:-1,u=Math.max(o.minLensSize,Math.min(o.maxLensSize,n-s*o.step)),d=Math.max(o.minLensSize,Math.min(o.maxLensSize,r-s*o.step)),h=(n-u)/2,p=(r-d)/2;n=u,r=d;let f=l.offset();l.css({width:n,height:r,top:f.top+p,left:f.left+h});let m=a.width()/n,c=a.height()/r,g=i.offset();a.css({backgroundSize:`${i.outerWidth()*m}px ${i.outerHeight()*c}px`,backgroundPosition:`-${(l.offset().left-g.left)*m}px -${(l.offset().top-g.top)*c}px`})}),e(document).on("mousemove."+s+" touchmove."+s,d),i.on("mouseleave."+s+" touchend."+s,function(){l.remove(),a.remove(),e(document).off("mousemove."+s+" touchmove."+s),e(window).off("wheel."+s),i.off("mouseleave."+s+" touchend."+s)}),d(t)}),this}}(jQuery);